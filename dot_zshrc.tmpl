# Oh My Zsh setup
export ZSH="$HOME/.oh-my-zsh"
export ZSH_DISABLE_COMPFIX=true

# Autosuggestions: configs devem vir antes de carregar o plugin
export ZSH_AUTOSUGGEST_USE_ASYNC=1
export ZSH_AUTOSUGGEST_STRATEGY=(history)

# Garante ~/.local/bin no PATH (para binários manuais como navi, lazygit, etc.)
case ":$PATH:" in *":$HOME/.local/bin:"*) ;; *) PATH="$HOME/.local/bin:$PATH" ;; esac
export PATH

DISABLE_UPDATE_PROMPT=true
zstyle ':omz:update' mode auto
zstyle ':omz:update' frequency 13

# Completion cache (acelera compinit)
[[ -d "$HOME/.zsh/.zcompcache" ]] || mkdir -p "$HOME/.zsh/.zcompcache"
zstyle ':completion:*' use-cache on
zstyle ':completion:*' cache-path "$HOME/.zsh/.zcompcache"

# Histórico do zsh
HISTFILE="$HOME/.zsh_history"
HISTSIZE=100000
SAVEHIST=$HISTSIZE
setopt HIST_IGNORE_ALL_DUPS HIST_REDUCE_BLANKS EXTENDED_HISTORY
setopt INC_APPEND_HISTORY SHARE_HISTORY  # grava em tempo real e compartilha entre shells

plugins=(
  git
  docker
  fzf
  aws
  gh
  gcloud
  mise
  sudo
)

# zsh-completions (3rd-party) — precisa estar no fpath ANTES do OMZ carregar completion
ZSH_CUSTOM="${ZSH_CUSTOM:-$HOME/.oh-my-zsh/custom}"
fpath=("$ZSH_CUSTOM/plugins/zsh-completions/src" $fpath)

source "$ZSH/oh-my-zsh.sh"

# zoxide init
eval "$(zoxide init zsh)"

# starship prompt
eval "$(starship init zsh)"

# zsh-autosuggestions (manual)
if [[ -d "$ZSH_CUSTOM/plugins/zsh-autosuggestions" ]]; then
  # tom suave para a sugestão (ajuste conforme tema)
  ZSH_AUTOSUGGEST_HIGHLIGHT_STYLE='fg=8'
  source "$ZSH_CUSTOM/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh"
fi

# zsh-syntax-highlighting — sempre por último
if [[ -d "$ZSH_CUSTOM/plugins/zsh-syntax-highlighting" ]]; then
  source "$ZSH_CUSTOM/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh"
fi

# Aliases fd/bat somente quando necessário (compat macOS/Ubuntu)
if ! command -v fd >/dev/null 2>&1 && command -v fdfind >/dev/null 2>&1; then
  alias fd='fdfind'
fi
if ! command -v bat >/dev/null 2>&1 && command -v batcat >/dev/null 2>&1; then
  alias bat='batcat'
fi

# --- Perfil Neovim leve como padrão (~/.config/nvim)
alias nv='nvim' 
#LazyVim
alias lv='NVIM_APPNAME=lazyvim nvim'
#LunarVim
alias lvv='lvim'